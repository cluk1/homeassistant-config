template:
  - sensor:
      - unique_id: flat1_energy_costs_day
        default_entity_id: sensor.flat1_energy_costs_day
        name: "Flat1 Energy Cost Today"
        device_class: monetary
        unit_of_measurement: €
        state: >
          {% if states('sensor.flat1_grid_energy_day') in ("unavailable", "unknown") %}
            {{ 'unknown' }}
          {% else %}
            {% set grid = states('sensor.flat1_grid_energy_day')|float %}
            {% set price = states('input_number.energy_grid_price')|float %}
            {{ ( grid * price / 100) | round(2) }}
          {% endif %}
      - unique_id: flat2_energy_costs_day
        default_entity_id: sensor.flat2_energy_costs_day
        name: "Flat2 Energy Cost Today"
        device_class: monetary
        unit_of_measurement: €
        state: >
          {% if states('sensor.flat2_grid_energy_day') in ("unavailable", "unknown") %}
            {{ 'unknown' }}
          {% else %}
            {% set grid = states('sensor.flat2_grid_energy_day')|float %}
            {% set price = states('input_number.energy_grid_price')|float %}
            {{ ( grid * price / 100) | round(2) }}
          {% endif %}
      - unique_id: flat3_energy_costs_day
        default_entity_id: sensor.flat3_energy_costs_day
        name: "Flat3 Energy Cost Today"
        device_class: monetary
        unit_of_measurement: €
        state: >
          {% if states('sensor.flat3_grid_energy_day') in ("unavailable", "unknown") %}
            {{ 'unknown' }}
          {% else %}
            {% set grid = states('sensor.flat3_grid_energy_day')|float %}
            {% set price = states('input_number.energy_grid_price')|float %}
            {{ ( grid * price / 100) | round(2) }}
          {% endif %}
      - unique_id: flat4_energy_costs_day
        default_entity_id: sensor.flat4_energy_costs_day
        name: "Flat4 Energy Cost Today"
        device_class: monetary
        unit_of_measurement: €
        state: >
          {% if states('sensor.flat4_grid_energy_day') in ("unavailable", "unknown") %}
            {{ 'unknown' }}
          {% else %}
            {% set grid = states('sensor.flat4_grid_energy_day')|float %}
            {% set price = states('input_number.energy_grid_price')|float %}
            {{ ( grid * price / 100) | round(2) }}
          {% endif %}
      - unique_id: comm_energy_costs_day
        default_entity_id: sensor.comm_energy_costs_day
        name: "Common Energy Cost Today"
        device_class: monetary
        unit_of_measurement: €
        state: >
          {% if states('sensor.comm_grid_energy_day') in ("unavailable", "unknown") %}
            {{ 'unknown' }}
          {% else %}
            {% set grid = states('sensor.comm_grid_energy_day')|float %}
            {% set price = states('input_number.energy_grid_price')|float %}
            {{ ( grid * price / 100) | round(2) }}
          {% endif %}
      - unique_id: heatpump_energy_costs_day
        default_entity_id: sensor.heatpump_energy_costs_day
        name: "Heatpump Energy Cost Today"
        device_class: monetary
        unit_of_measurement: €
        state: >
          {% if states('sensor.heatpump_grid_energy_day') in ("unavailable", "unknown") %}
            {{ 'unknown' }}
          {% else %}
            {% set grid = states('sensor.heatpump_grid_energy_day')|float %}
            {% set price = states('input_number.energy_grid_price_heatpump')|float %}
            {{ ( grid * price / 100) | round(2) }}
          {% endif %}
      - unique_id: wallbox_cp1_energy_costs_day
        default_entity_id: sensor.wallbox_cp1_energy_costs_day
        name: "Wallbox CP1 Charging Cost Today"
        device_class: monetary
        unit_of_measurement: €
        state: >
          {% if states('sensor.wallbox_cp1_grid_energy_day') in ("unavailable", "unknown") %}
            {{ 'unknown' }}
          {% else %}
            {% set grid = states('sensor.wallbox_cp1_grid_energy_day')|float %}
            {% set price = states('input_number.energy_grid_price')|float %}
            {{ ( grid * price / 100) | round(2) }}
          {% endif %}
      - unique_id: wallbox_cp2_energy_costs_day
        default_entity_id: sensor.wallbox_cp2_energy_costs_day
        name: "Wallbox CP2 Charging Cost Today"
        device_class: monetary
        unit_of_measurement: €
        state: >
          {% if states('sensor.wallbox_cp2_grid_energy_day') in ("unavailable", "unknown") %}
            {{ 'unknown' }}
          {% else %}
            {% set grid = states('sensor.wallbox_cp2_grid_energy_day')|float %}
            {% set price = states('input_number.energy_grid_price')|float %}
            {{ ( grid * price / 100) | round(2) }}
          {% endif %}
